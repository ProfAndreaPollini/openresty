2025/10/05 09:23:36 [info] 7#0: *2 [lua] casbin_check.lua:118: get_casbin(): Successfully loaded Casbin module, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [info] 7#0: *2 [lua] casbin_check.lua:324: abac_check(): ABAC Request: {"env":{"ip":"172.25.0.1","time":9,"user_agent":"curl\/8.14.1","connection_type":"proxy","day_of_week":"0"},"obj":{"protocol":"http","domain":"andreapollini.com","full_host":"andreapollini.com","port":"443"},"act":"connect","sub":{"authenticated":false,"name":"alice","group":"guest","role":"user"}}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [info] 7#0: *2 [lua] casbin_check.lua:328: abac_check(): Attempting to create Casbin enforcer with model: /etc/nginx/conf/access_model.conf and policy: /etc/nginx/conf/access_rules.csv, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFOModel: 
, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFO[m.m]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFO{RM = {}, key = "m", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {}, value = "eval(p_sub_rule) && eval(p_obj_rule) && eval(p_act_rule) && eval(p_env_rule)"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFO[r.r]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFO{RM = {}, key = "r", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {"r_sub", "r_obj", "r_act", "r_env"}, value = "sub, obj, act, env"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFO[e.e]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFO{RM = {}, key = "e", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {}, value = "some(where (p_eft == allow))"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFO[p.p]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFO{RM = {}, key = "p", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {"p_sub_rule", "p_obj_rule", "p_act_rule", "p_env_rule", "p_eft"}, value = "sub_rule, obj_rule, act_rule, env_rule, eft"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFOPolicy: 
, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFOp:   sub_rule, obj_rule, act_rule, env_rule, eft:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFO{{"r.sub.authenticated == false", "r.obj.domain == \"andreapollini.com\"", "r.act == \"connect\"", "true", "deny"}, {"true", "true", "true", "true", "deny"}}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [info] 7#0: *2 [lua] casbin_check.lua:152: create_enforcer_safe(): Successfully created Casbin enforcer using approach 1, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [info] 7#0: *2 [lua] casbin_check.lua:345: abac_check(): Successfully created Casbin enforcer, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [notice] 7#0: *2 [lua] Log.lua:29: info(): INFORequest: { authenticated = false, name = alice, group = guest, role = user }, { protocol = http, domain = andreapollini.com, full_host = andreapollini.com, port = 443 }, connect, { ip = 172.25.0.1, time = 9, user_agent = curl/8.14.1, connection_type = proxy, day_of_week = 0 } ---> false
, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [warn] 7#0: *2 [lua] casbin_check.lua:362: abac_check(): Access DENIED by Casbin ABAC for user=alice group=guest to domain=andreapollini.com from IP=172.25.0.1, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:23:36 [info] 7#0: *2 client 172.25.0.1 closed keepalive connection
2025/10/05 09:24:42 [info] 8#0: *3 [lua] casbin_check.lua:118: get_casbin(): Successfully loaded Casbin module, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [info] 8#0: *3 [lua] casbin_check.lua:324: abac_check(): ABAC Request: {"env":{"ip":"172.25.0.1","time":9,"user_agent":"curl\/8.14.1","connection_type":"proxy","day_of_week":"0"},"obj":{"protocol":"http","domain":"andreapollini.com","full_host":"andreapollini.com","port":"443"},"act":"connect","sub":{"authenticated":false,"name":"alice","group":"guest","role":"user"}}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [info] 8#0: *3 [lua] casbin_check.lua:328: abac_check(): Attempting to create Casbin enforcer with model: /etc/nginx/conf/access_model.conf and policy: /etc/nginx/conf/access_rules.csv, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFOModel: 
, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFO[m.m]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFO{RM = {}, key = "m", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {}, value = "eval(p_sub_rule) && eval(p_obj_rule) && eval(p_act_rule) && eval(p_env_rule)"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFO[r.r]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFO{RM = {}, key = "r", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {"r_sub", "r_obj", "r_act", "r_env"}, value = "sub, obj, act, env"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFO[e.e]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFO{RM = {}, key = "e", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {}, value = "some(where (p_eft == allow))"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFO[p.p]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFO{RM = {}, key = "p", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {"p_sub_rule", "p_obj_rule", "p_act_rule", "p_env_rule", "p_eft"}, value = "sub_rule, obj_rule, act_rule, env_rule, eft"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFOPolicy: 
, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFOp:   sub_rule, obj_rule, act_rule, env_rule, eft:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFO{{"r.sub.authenticated == false", "r.obj.domain == \"andreapollini.com\"", "true", "true", "deny"}, {"true", "true", "true", "true", "deny"}}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [info] 8#0: *3 [lua] casbin_check.lua:152: create_enforcer_safe(): Successfully created Casbin enforcer using approach 1, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [info] 8#0: *3 [lua] casbin_check.lua:345: abac_check(): Successfully created Casbin enforcer, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [notice] 8#0: *3 [lua] Log.lua:29: info(): INFORequest: { authenticated = false, name = alice, group = guest, role = user }, { protocol = http, domain = andreapollini.com, full_host = andreapollini.com, port = 443 }, connect, { ip = 172.25.0.1, time = 9, user_agent = curl/8.14.1, connection_type = proxy, day_of_week = 0 } ---> false
, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [warn] 8#0: *3 [lua] casbin_check.lua:362: abac_check(): Access DENIED by Casbin ABAC for user=alice group=guest to domain=andreapollini.com from IP=172.25.0.1, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:24:42 [info] 8#0: *3 client 172.25.0.1 closed keepalive connection
2025/10/05 09:27:04 [info] 10#0: *4 [lua] casbin_check.lua:118: get_casbin(): Successfully loaded Casbin module, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [info] 10#0: *4 [lua] casbin_check.lua:324: abac_check(): ABAC Request: {"env":{"ip":"172.25.0.1","time":9,"user_agent":"curl\/8.14.1","connection_type":"proxy","day_of_week":"0"},"obj":{"protocol":"http","domain":"andreapollini.com","full_host":"andreapollini.com","port":"443"},"act":"connect","sub":{"authenticated":false,"name":"alice","group":"guest","role":"user"}}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [info] 10#0: *4 [lua] casbin_check.lua:328: abac_check(): Attempting to create Casbin enforcer with model: /etc/nginx/conf/access_model.conf and policy: /etc/nginx/conf/access_rules.csv, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFOModel: 
, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFO[m.m]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFO{RM = {}, key = "m", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {}, value = "eval(p_sub_rule) && eval(p_obj_rule) && eval(p_act_rule) && eval(p_env_rule)"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFO[r.r]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFO{RM = {}, key = "r", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {"r_sub", "r_obj", "r_act", "r_env"}, value = "sub, obj, act, env"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFO[e.e]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFO{RM = {}, key = "e", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {}, value = "some(where (p_eft == allow))"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFO[p.p]:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFO{RM = {}, key = "p", policy = {}, policyMap = {}, priorityIndex = -1, tokens = {"p_sub_rule", "p_obj_rule", "p_act_rule", "p_env_rule", "p_eft"}, value = "sub_rule, obj_rule, act_rule, env_rule, eft"}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFOPolicy: 
, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFOp:   sub_rule, obj_rule, act_rule, env_rule, eft:, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFO{{"r.sub.authenticated == false", "r.obj.domain == \"andreapollini.com\"", "true", "true", "allow"}, {"true", "true", "true", "true", "deny"}}, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [info] 10#0: *4 [lua] casbin_check.lua:152: create_enforcer_safe(): Successfully created Casbin enforcer using approach 1, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [info] 10#0: *4 [lua] casbin_check.lua:345: abac_check(): Successfully created Casbin enforcer, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [notice] 10#0: *4 [lua] Log.lua:29: info(): INFORequest: { authenticated = false, name = alice, group = guest, role = user }, { protocol = http, domain = andreapollini.com, full_host = andreapollini.com, port = 443 }, connect, { ip = 172.25.0.1, time = 9, user_agent = curl/8.14.1, connection_type = proxy, day_of_week = 0 } ---> true
Hit Policy: { r.sub.authenticated == false, r.obj.domain == "andreapollini.com", true, true, allow }, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
2025/10/05 09:27:04 [info] 10#0: *4 [lua] casbin_check.lua:368: abac_check(): Access GRANTED by Casbin ABAC for user=alice group=guest to domain=andreapollini.com from IP=172.25.0.1, client: 172.25.0.1, server: , request: "CONNECT andreapollini.com:443 HTTP/1.1", host: "andreapollini.com:443"
